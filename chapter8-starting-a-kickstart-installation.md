# 第八章 启动kickstart安装 


在开始kickstart安装前，你必须通过Fedora或RHEL的引导盘启动系统，并在引导提示符数据特殊的启动命令；其中引导盘包括各自的软盘启动盘、光盘启动盘、光盘一号盘。为了进入引导提示符界面，你必须在显示CD or DVD启动菜单时按ESC键。如果你还不懂，那就看图吧。如果将ks命令行参数传递给了内核，安装系统会查找KickstartFile文件。

![FEDORA_BOOT_SCREEN](./images/fedora_boot_screen.png?800)


## 软盘启动 

如果在软盘启动盘上找到了KickstartFile文件(如第六章创建软盘启动部分描述)，那么从软盘引导启动系统，并在引导提示符界面输入以下命令：  

```bash
linux ks=floppy

```


## CD-ROM #1 和 软盘 

Linux命令ks=floppy同样对软盘上的vfat和ext2文件系统上的ks.cfg有效，并从一号光盘启动启动Fedora或RHEL。

使用一个命令交替引导Fedora或RHEL一号光盘和在vfat或ext2文件系统上有KickstartFile文件的软盘。为了实现这个方式，在引导提示符界面使用随后命令：    

```bash 

linux ks=hd:fd0:/ks.cfg

```



## 与硬盘搭配 

如果你的kickstart需要使用硬盘，指定dd选项。例如，引导软盘安装盘并使用硬盘，在引导提示符界面使用随后命令：    

```bash

linux ks=floppy dd

```



## 光盘启动 

如果KickstartFile文件在启动光盘上(如第六章创建光盘启动部分描述)，插入光盘，启动系统，在引导提示符界面使用随后命令(ks.cfg为KickstartFile文件名)：    

```bash

linux ks=cdrom:<device>:/ks.cfg

```



## 其他kickstart选项 

  + ks=nfs:<server>:/<path>
    + 安装程序将在NFS服务器<server>上搜索KickstartFile文件，文件名为<path>。安装程序将使用DHCP配置网卡。例如，如果你的NFS服务器是server.example.com，KickstartFile文件为NFS服务器上的共享/mkdir/ks.cfg内，正确的启动命令应该是    

```bash


ks=nfs:server.example.com:/mydir/ks.cfg


```


	
  + ks=http://<server>/<path>
    + 安装程序将在HTTP服务器<server>上搜索KickstartFile文件，文件名为<path>。安装程序将使用DHCP配置网卡。例如，如果你的HTTP服务器是server.example.com，KickstartFile文件为服务器上的HTTP目录/mkdir/ks.cfg内，正确的启动命令应该是   

```bash


ks=http://server.example.com/mkdir/ks.cfg。


```


  + ks=floppy
    + 安装程序将搜索软盘(设备号/dev/fd0)上的vfat或ext2文件系统上的ks.cfg文件。
  + ks=floppy:/<path>
    + 安装程序将在软盘(设备号/dev/fd0)上搜索KickstartFile文件，文件为<path>
  + ks=hd:<device>:/<file>
    + 安装程序将文件系统挂载到设备<device>(必须为vfat或ext2)上，并查找kickstart配置文件<file>。例如:  

```bash


	ks=hd:sda3:/mydir/ks.cfg。


```	


  + ks=bd:<biosdev>:/<path>
    + 安装程序将挂载文件系统到指定BIOS设备<biosdev>上的指定分区(例如, ks=bd:80p3:/mydir/ks.cfg)。注意，该项对BIOS阵列无效。
  + ks=file:/<file>
    + 安装程序将尝试读取系统上的文件<file>；虽然没被挂载但可以这样做。通常用于kickstart文件已经在initrd image上。
  + ks=cdrom:/<path> 或更新版本 ks=cdrom:<cdrom device>:/<path>
    + 安装程序将在CDROM上查找kickstart文件，文件为<path>
  + ks
    +  如果单独使用，安装程序将使用DHCP配置网卡。如果是用过NFS服务器共享kickstart文件，那么将从DHCP返回的"bootServer"上读取该kickstart文件。默认，bootServer与DHCP服务器是同一台服务器。kickstart文件为随后情况之一：
      +  如果DHCP指定了bootfile，且bootfile以斜线"/"开头，在NFS服务器上查找由DHCP提供的bootfile。
      +  如果DHCP指定了bootfile，且bootfile以其他字符开头并以斜线结尾(如/kickstart/)，在NFSF服务器的/kickstart目录上查找由DHCP提供的bootfile。
      +  如果DHCP没有指定bootfile，那么安装程序将尝试读取文件/kickstart/1.2.3.4-kickstart，1.2.3.4为将安装系统的机器的十进制IP。
  + ksdevice=<device>
    + 安装程序将使用该网络设备连接网络。例如，需要启动kickstart安装时使用eth1设备访问NFS服务器上的kickstart文件，则在引导提示符界面使用如下命令：   

```bash


ks=nfs:<server>:/<path> ksdevice=eth1。


```    查看更多信息，可以参考[Anaconda_Boot_Options ]( http://fedoraproject.org/wiki/Anaconda_Boot_Options )



## Kickstart脚本例子 

自从收到了成堆的错误，就觉得自己该共享一个kikcstart脚本的例子。该脚本也是一个关于安装lvm的例子。我无法在其他地方找个一个更好的关于lvm的例子。同时，我在我觉得有帮助的地方添加了一些注释。如果你觉得有比这个更好的例子，请修改或者另行挖坑。



```bash


# Kickstart file automatically generated by anaconda.

#version=DEVEL
#url --url http://mirrors.kernel.org/fedora/releases/7/Fedora/i386/os
#ks=http://127.0.0.1/ks.cfg
#ks=http://localhost/ks.cfg
url --url http://ftp.usf.edu/pub/fedora/linux/releases/14/Fedora/i386/os
install
cdrom
lang en_US.UTF-8
keyboard us
network --onboot yes --device eth0 --bootproto dhcp --noipv6
timezone --utc America/New_York
rootpw  + -iscrypted $6$s9i1bQbmW4oSWMJc$0oHfSz0b/d90EvHx7cy70RJGIHrP1awzAgL9A3x2tbkyh72P3kN41vssaI3/SJf4Y4qSo6zxc2gZ3srzc4ACX1
selinux --permissive
authconfig --enableshadow --passalgo=sha512 --enablefingerprint
firewall --service=ssh
# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work

#I am deleting the old partitions with this
clearpart --all --drives=sda

#I am creating partitions here
#I will create the lvm stuff farther down
part /boot --fstype=ext4 --size=500 --ondisk=sda --asprimary
part pv.5xwrsR-ldgG-FEmM-2Zu5-Jn3O-sx9T-unQUOe --grow --size=500 --ondisk=sda --asprimary

#Very important to have the two part lines before the lvm stuff
volgroup VG --pesize=32768 pv.5xwrsR-ldgG-FEmM-2Zu5-Jn3O-sx9T-unQUOe
logvol / --fstype=ext4 --name=lv_root --vgname=VG --size=40960
logvol /home --fstype=ext4 --name=lv_home --vgname=VG --size=25600
logvol swap --fstype swap --name=lv_swap --vgname=VG --size=4096

bootloader --location=mbr --driveorder=sda --append="rhgb quiet"

%packages
@admin-tools
#@editors
#@fonts
@gnome-desktop
#@games
#@graphical-internet
#@graphics
@hardware-support
@input-methods
#@java
#@office
#@online-docs
@printing
@sound-and-video
@text-internet
@base-x
xfsprogs
mtools
#gpgme
#openoffice.org-opensymbol-fonts
#gvfs-obexftp
hdparm
#gok
#iok
#vorbis-tools
jack-audio-connection-kit
#ncftp
gdm
%end

# Reboot after installation
reboot
  


```

